<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snapshot-Centered Project Workflow • cynkrathis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<link href="../extra.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Snapshot-Centered Project Workflow">
<meta property="og:description" content="cynkrathis">
<meta property="og:image" content="/logo.svg">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="cynkra-logo-font" href="https://www.cynkra.com">cynkra</a>
        <a class="cynkra-logo" href="https://www.cynkra.com">■</a>
        <a class="navbar-brand" href="../index.html">cynkrathis <small>v0.3.3</small></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-left">
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rspm-snaphots.html">Snapshot-Centered Project Workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.cynkra.com/projects.html">Projects</a>
</li>
<li>
  <a href="https://www.cynkra.com/consulting.html">Consulting</a>
</li>
<li>
  <a href="https://github.com/cynkra/cynkrathis/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="rspm-snaphots_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Snapshot-Centered Project Workflow</h1>
                        <h4 class="author">Patrick Schratz, Kirill Müller</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cynkra/cynkrathis/blob/master/vignettes/rspm-snaphots.Rmd"><code>vignettes/rspm-snaphots.Rmd</code></a></small>
      <div class="hidden name"><code>rspm-snaphots.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This post aims at explaining this <strong>“snapshot-centered project workflow”</strong> in greater detail. This approach is actively promoted and used within projects at cynkra. It plays particular well with a centralized RStudio Workbench installation when collaborating with multiple people on a project. Yet it is quite universal and can be used by anyone if desired.</p>
<p>Note that by default this workflows uses a combination of {renv}, RStudio Package Manager (RSPM) and {cynkrathis} but can also be applied with only subsets of such.</p>
<p>{cynkrathis} provides functions which contribute to this opinionated project workflow approach:</p>
<ul>
<li><code><a href="../reference/get_snapshots.html">get_snapshots()</a></code></li>
<li><code><a href="../reference/renv_switch_r_version.html">renv_switch_r_version()</a></code></li>
<li><code><a href="../reference/renv_downgrade.html">renv_downgrade()</a></code></li>
</ul>
<p>These little helper functions play an important role in making this workflow fun to apply. We will explain their use throughout this article.</p>
<p>The key idea of the workflow lies in the use of a specific R version coupled with an RSPM snapshot. Using a specific RSPM snapshot in <code><a href="https://rdrr.io/r/base/options.html">options(repos = )</a></code> means that the project has only access to a static package source in contrast to a dynamic one when using a classic <a href="https://cran.r-project.org/mirrors.html">CRAN mirror</a> such as <a href="https://cloud.r-project.org/" class="uri">https://cloud.r-project.org/</a>.</p>
<p>What is meant by “static and dynamic package sources” exactly?<br>
By default, CRAN mirrors provide new package updates as they are released on CRAN. Hence, if one calls <code><a href="https://rdrr.io/r/utils/update.packages.html">update.packages()</a></code> daily, there will always be some packages being updated to their newest version. This might be desired for R package development byt problematic for analysis projects, as every package update comes with the potential to break the analysis.<br>
Instead, a “static package source” only refers to a CRAN snapshot on a specific day and does not provide any other CRAN package version than the versions available at this specfic day in time.</p>
<p>Using a “static package source” for analysis projects has the following advantages:</p>
<ul>
<li>Stable project environment by making use of packages which are likely to play together well.</li>
<li>Package versions which are known to work with the R version used.</li>
<li>Possibility of controlled package updates between RSPM snapshots.</li>
</ul>
<p>The combination of an specific R version and a RSPM snapshot is ensured by {renv}. In <code>renv.lock</code>, the R version and snapshot ID are listed.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">{</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="dt">"R"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="dt">"Version"</span><span class="fu">:</span> <span class="st">"4.1.0"</span><span class="fu">,</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="dt">"Repositories"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>      <span class="fu">{</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>        <span class="dt">"Name"</span><span class="fu">:</span> <span class="st">"CRAN"</span><span class="fu">,</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>        <span class="dt">"URL"</span><span class="fu">:</span> <span class="st">"https://packagemanager.rstudio.com/cran/2021-05-18"</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>      <span class="fu">}</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>    <span class="ot">]</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="fu">},</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="er">[...]</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">}</span></span></code></pre></div>
</div>
<div id="the-nature-of-snapshot-centered-workflows" class="section level2">
<h2 class="hasAnchor">
<a href="#the-nature-of-snapshot-centered-workflows" class="anchor"></a>The nature of snapshot-centered workflows</h2>
<p>Now when a project is initiated with {renv} and packages are installed, only packages from this specific snapshot are installed. A “snapshot” here means that the repo where packages are looked up contains only the CRAN sources of this specific day in time. No additional packages will be available/added to this snapshot in the future.</p>
<p>This might seem limiting on the first look but we believe that it is actually a feature. Often when collaborating with other people, multiple people install packages at different stages of a project lifetime.</p>
<p>Let’s compare the scenario of a <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("dplyr")</a></code> call eight weeks after project start. <strong>Without a fixed snapshot</strong>, this would look as follows:</p>
<ol style="list-style-type: decimal">
<li>A user installs {dplyr} five weeks after the project has started.</li>
<li>Meanwhile, {dplyr} was updated and with it some dependencies of it (maybe even the minimum versions were bumped). Hence, <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("dplyr")</a></code> will also update more recent versions of other packages than just {dplyr}.</li>
<li>These updates have the potential to break some analysis in the project, possibly without anyone realizing.</li>
</ol>
<p>In contrast, when <strong>using a snapshot-centered approach</strong>, <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("dplyr")</a></code> eight weeks after project start</p>
<ol style="list-style-type: decimal">
<li>will not cause any updates of already installed packages bcausse the {dplyr} version which is going to be installed will be the {dplyr} version at the point in time referenced by the RSPM snapshot.</li>
<li>Already installed packages will not be installed again (thanks to {renv} and most importantly, no updates will be installed.</li>
</ol>
</div>
<div id="practical-implications-and-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#practical-implications-and-usage" class="anchor"></a>Practical implications and usage</h2>
<p>Next, let’s discuss some practical questions which will be coming up at some point during the analysis:</p>
<ul>
<li>How do I upgrade/downgrade a single/all packages?</li>
<li>How do I upgrade the R version?</li>
</ul>
<div id="using-packages-not-available-in-the-rspm-snapshot" class="section level3">
<h3 class="hasAnchor">
<a href="#using-packages-not-available-in-the-rspm-snapshot" class="anchor"></a>Using packages not available in the RSPM snapshot</h3>
<p>Often enough there is the need to use packages which are not available in the RSPM snapshot, for example packages living only on GitHub or newer versions of packages. In general we recommend trying to get along with the packages available in the snapshot. If this is not possible for whatever reason, there is always the possibility to install a specific package from GitHub and track its exact version via {renv}.</p>
<p>The possible downsides of this is that this installation will most likely update multiple packages in the project library and hence possibly break the stability of the fixed project library. While this is unavoidable if packages are only available on GitHub, the case is slightly different if a newer version of a package available on CRAN is needed. In this case, one might want to consider bumping the entire snapshot ID to one which satisfies the requirement needed.</p>
<p>This leads to the point of using an alternative snapshot which we discuss in separate section.</p>
</div>
<div id="using-alternative-snapshots-for-specific-r-versions" class="section level3">
<h3 class="hasAnchor">
<a href="#using-alternative-snapshots-for-specific-r-versions" class="anchor"></a>Using alternative snapshots for specific R versions</h3>
<p>By default, {cynkrathis} couples a R version with the snapshot of the day on which the R version has been released (see <code><a href="../reference/get_snapshots.html">get_snapshots()</a></code>).</p>
<p>However, there are certain happenings during the time window until the next R version release (which is usually ~ 2 - 4 months) which can lead to the assignment of additional snapshots to a specific R version:</p>
<ul>
<li>Important updates to certain R packages might happen which provide added value to a project</li>
<li>The snapshot assigned on the release date of the R version might inherit some incompatibilities between packages by chance. For example, it might be a package of your choice was updated the day before the snapshot and now does not play well with another package.</li>
</ul>
<p>In such cases, we at cynkra add another snapshot to an R version. The source for these assignment lives in a <a href="https://github.com/cynkra/cynkrathis/blob/main/snapshots/snapshots.json">JSON file in the cynkrathis package</a>. Now you might wonder where and how you can see which snapshots belong to which R version without looking at this JSON file all the time? Good question! Let’s discuss this in the next section.</p>
</div>
<div id="retrieving-snapshot-information" class="section level3">
<h3 class="hasAnchor">
<a href="#retrieving-snapshot-information" class="anchor"></a>Retrieving snapshot information</h3>
<p><code><a href="../reference/get_snapshots.html">cynkrathis::get_snapshots()</a></code> returns snapshot information. Let’s look at the output and break down what information can be extracted from this output.</p>
<pre><code>#&gt;         id r_version r_release_date       date        type                                 note
#&gt; 17 4804401     4.1.1     2021-08-10 2021-08-30                      RSQLite 2.2.8, tibble 3.1.4
#&gt; 16 4520552     4.1.1     2021-08-10 2021-08-10 recommended                                     
#&gt; 15 4392527     4.1.0     2021-05-18 2021-07-29                                     pillar 1.6.2
#&gt; 14 3656918     4.1.0     2021-05-18 2021-06-21                                         dm 0.2.3
#&gt; 13 3317876     4.1.0     2021-05-18 2021-06-05                                      fansi 0.5.0
#&gt; 12 2976243     4.1.0     2021-05-18 2021-05-18 recommended dm 0.2.1, tibble 3.1.2, pillar 1.6.1
#&gt; 11 2866992     4.0.5     2021-03-31 2021-05-12                                                 
#&gt; 10 2511902     4.0.5     2021-03-31 2021-04-23 recommended                                     
#&gt; 9  2080338     4.0.5     2021-03-31 2021-03-31                                      vctrs 0.3.7
#&gt; 8  1987521     4.0.4     2021-03-26 2021-03-26                                      dplyr 1.0.5</code></pre>
<ul>
<li>Column <code>id</code> refers to the internal RSPM (packagemanager.rstudio.com) ID of the respective snapshot.</li>
<li>Each observations lists the snapshot date (<code>date</code>) and the respective release date (<code>r_release_date</code>) of the associated R version.</li>
<li>Column <code>note</code> gives some information about a particular snapshot.</li>
<li>Column <code>type</code> denotes the default snapshot of a particular R version when its tagged as “recommended”.</li>
<li>Each R version can have multiple snapshots assigned.</li>
</ul>
</div>
</div>
<div id="updating-snapshots" class="section level2">
<h2 class="hasAnchor">
<a href="#updating-snapshots" class="anchor"></a>Updating snapshots</h2>
<p>By default we recommend to always update snapshots when you update your R version so that the R version is always coupled with a snapshot listed in <code><a href="../reference/get_snapshots.html">get_snapshots()</a></code>.</p>
<p>There are two different scenarios:</p>
<ol style="list-style-type: decimal">
<li>Updating/downgrading an R version</li>
<li>Upgrading/downgrading <strong>snapshots only</strong> and keeping the same R version</li>
</ol>
<div id="upgradingdowngrading-r-versions" class="section level3">
<h3 class="hasAnchor">
<a href="#upgradingdowngrading-r-versions" class="anchor"></a>Upgrading/downgrading R versions</h3>
<p>When you decided to update a given snapshot because of an R version upgrade, one can make use of <code><a href="../reference/renv_switch_r_version.html">renv_switch_r_version()</a></code>. This function knows which snapshot is the default for which R version. Hence, there is no need to look up which snapshot ID to use when switching between R versions.</p>
<p>Let’s say one wants to switch to R 4.0.5. In this case, you can do</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">renv_switch_r_version</span>(<span class="st">"4.0.5"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>→ Replacing R Version and RSPM snapshot <span class="cf">in</span> renv.lock.</span>
<span id="cb3-3"><a href="#cb3-3"></a>✓ New R Version<span class="op">:</span><span class="st"> </span><span class="dv">4</span>.<span class="dv">0</span>.<span class="fl">5.</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>✓ New RSPM snapshot<span class="op">:</span><span class="st"> </span><span class="dv">2021-04</span><span class="fl">-23.</span></span></code></pre></div>
</div>
<div id="upgrading-snapshots-and-keeping-the-same-r-version" class="section level3">
<h3 class="hasAnchor">
<a href="#upgrading-snapshots-and-keeping-the-same-r-version" class="anchor"></a>Upgrading snapshots and keeping the same R version</h3>
<p>Here it is hard to guess which snapshot one desires to use as <code><a href="../reference/renv_switch_r_version.html">renv_switch_r_version()</a></code> will always use the snapshot ID tagged as “recommened” in <code><a href="../reference/get_snapshots.html">get_snapshots()</a></code>. Most often this is already the snapshot ID in use for the particular R version. If a different snapshot should be used, manual adjustments is required.</p>
<p>First, look up the snapshot you want to use by calling <code><a href="../reference/get_snapshots.html">get_snapshots()</a></code>. Then simply replace the snapshot ID in line 7 of <code>renv.lock</code>.</p>
<p>One can use any snapshot ID/date available and the ones returned by <code><a href="../reference/get_snapshots.html">get_snapshots()</a></code> are only recommendations of cynkra but might not work for you personally. If you have good arguments why another snapshot might be helpful for a particular R version, you are welcome to open PR and share your thoughts with us!</p>
<p>OK - let’s assume that you have updated/downgraded your snapshot: the last step would be to update the actual installed packages. Now that there is another snapshot in place, you have new package sources available and should synchronize your project library to it.</p>
<p>That said, for updating call <code><a href="https://rstudio.github.io/renv/reference/update.html">renv::update()</a></code>. {renv} will show you a list of changes which will be applied and which packages will be updated to which version. Here a short example:</p>
<pre><code>- gh             [1.2.0 -&gt; 1.3.0]
- highr          [0.8 -&gt; 0.9]
- jquerylib      [0.1.3 -&gt; 0.1.4]</code></pre>
<p>Last, call <code><a href="https://rstudio.github.io/renv/reference/snapshot.html">renv::snapshot()</a></code> to record the new versions in the lockfile.</p>
</div>
<div id="downgrading-snapshots-and-keeping-the-same-r-version" class="section level3">
<h3 class="hasAnchor">
<a href="#downgrading-snapshots-and-keeping-the-same-r-version" class="anchor"></a>Downgrading snapshots and keeping the same R version</h3>
<p>Downgrading is a bit more complicated but do not worry - {cynkrathis} got you covered. There is no dedicated <code>downgrade()</code> function because by default this function would not know which version to match against for the downgrade (remember, RSPM snapshots are not used by default by {renv}). One option is to go with <code><a href="https://rstudio.github.io/renv/reference/revert.html">renv::revert()</a></code> and restore the lockfile contents of a previous commit. However, this approach has the downside that it does not account for possible new changes to the lockfile one has made meanwhile.</p>
<p>What you actually want is to <em>restore all packages listed in the lockfile with their version available in the configured snapshot</em>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">installed_pkgs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span>lib.loc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/libPaths.html">.libPaths</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>, <span class="st">"Package"</span><span class="op">]</span><span class="op">)</span>
<span class="fu">renv</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/renv/reference/install.html">install</a></span><span class="op">(</span><span class="va">installed_pkgs</span><span class="op">)</span></code></pre></div>
<p>The snippet above will install all installed packages again using the version of the snapshot date listed in <code>renv.lock</code>. Luckily, there is a function in {cynkrathis} to simplify this: <code><a href="../reference/renv_downgrade.html">renv_downgrade()</a></code>. It will restart the session to ensure it is picking up the correct repo option and then execute the calls shown above.</p>
<p>Next, call <code><a href="https://rstudio.github.io/renv/reference/snapshot.html">renv::snapshot()</a></code> and you’re good to go.</p>
<p>The output should look similar as the following one</p>
<pre><code>- testthat       [3.0.2 -&gt; 3.0.1]
- textshaping    [0.3.4 -&gt; 0.2.1]</code></pre>
</div>
</div>
<div id="default-renv-options-and-settings" class="section level2">
<h2 class="hasAnchor">
<a href="#default-renv-options-and-settings" class="anchor"></a>Default {renv} options and settings</h2>
<p>We also recommend to set some default {renv} options and settings to make project work even more enjoyable. There are more potential settings which might need adjustments when administrating a RStudio Workbench instance for multiple people.</p>
<table class="table">
<colgroup>
<col width="51%">
<col width="24%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Value</th>
<th>Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>renv.config.auto.snapshot</code></td>
<td>FALSE</td>
<td>option</td>
</tr>
<tr class="even">
<td><code>RENV_PATHS_PREFIX_AUTO</code></td>
<td>TRUE</td>
<td>Env var</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p><code>renv.config.auto.snapshot</code>: There are different scenarios in which <code>env.config.auto.snapshot = TRUE</code> can lead to undesired situations:</p>
<ol style="list-style-type: decimal">
<li><p>If the R session was not restarted for some time and a collaborator updated <code>renv.lock</code> meanwhile on the git remote, one does not get a reminder that the package library is out of sync. If one new installs a new package, auto-snapshot kicks in causing <code>renv.lock</code> to become a potential merge conflict. If this file is now commited before changes are pulled (possibly due to some automation happening), the push is rejected and the conflicts needs to be solved first.</p></li>
<li><p>Even if one gets a remember and restores the remote state first, the restore may fail. One might frantically try to install packages manually, which works, but then auto-snapshot writes a bogus state into the lock file.</p></li>
<li><p>If everything works out great, and one actually manages to restore cleanly and install new packages, now everybody else immediately sees all intermediate experiments with packages that one did to test-drive and then later removed again. “Ideally”, one commits straight to the main branch, so that everybody can track the flow of ones exploration and happily installs all the packages which have been touched to their library, only to remove then again later.</p></li>
</ol>
<p>These are just a few scenarios which actually happened in practice. With manual snapshots, we decouple snapshotting from restoring and installing, which gives us a bit more control. This works because in a multi-user project there is often one or few contributors who define the package environment, and the others just follow (and don’t need this setting, to begin with).</p>
</li>
<li><p><code>RENV_PATHS_PREFIX_AUTO</code>: When setting this environment variable to <code>TRUE</code>, {renv} will create OS-aware project libraries. This prevents conflicts after OS upgrades, especially on Linux. For example, binary packages on Ubuntu are not compatible across LTS versions because they link against specific system libraries which differe between these OS versions. Without this setting, {renv} would try to re-use already existing packages which then leads to errors during load-time.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="footer-left">
  <p>cynkrathis is sponsored by <a class="cynkra-logo-font-footer" href="https://www.cynkra.com">cynkra</a><a class="cynkra-logo-footer" href="https://www.cynkra.com">■</a>. Learn more at <a href="https://www.cynkra.com/">www.cynkra.com</a>.</p>
</div>

<div class="footer-right">
  <p>Developed by <a href="https://pat-s.me">Patrick Schratz</a>, <a href="http://krlmlr.info">Kirill Müller</a>.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
